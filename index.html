<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Fishing Strategy</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to right, #e0f7fa, #b2ebf2);
      color: #004d40;
      margin: 0;
      padding: 20px;
    }
    .container {
      max-width: 800px;
      margin: auto;
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    h1 {
      text-align: center;
      color: #00796b;
    }
    label, select, input, button {
      display: block;
      margin: 10px 0;
      width: 100%;
      font-size: 16px;
    }
    button {
      background: #00796b;
      color: white;
      border: none;
      padding: 10px;
      border-radius: 6px;
      cursor: pointer;
    }
    button:hover {
      background: #004d40;
    }
    .output-box {
      background: #f1f8e9;
      border-left: 5px solid #cddc39;
      margin-top: 20px;
      padding: 15px;
    }
    .lang-switch {
      float: right;
    }
  </style>
</head>
<body>
<div class="container">
  <div class="lang-switch">
    <label><input type="checkbox" id="langToggle"> à¦¬à¦¾à¦‚à¦²à¦¾</label>
  </div>
  <h1 id="title">AI Fishing Strategy</h1>

  <button onclick="detectLocation()">ğŸ“ Detect My Location</button>

  <label id="locLabel">Enter Location:</label>
  <input type="text" id="location" placeholder="e.g., Kolkata">

  <label id="dateLabel">Choose Date:</label>
  <input type="date" id="fishingDate">

  <button onclick="getFishingPrediction()" id="predictBtn">Get Prediction</button>

  <div class="output-box" id="result"></div>
  <div class="output-box" id="fishSpecies"></div>
</div>

<script>
const langData = {
  en: {
    title: "AI Fishing Strategy",
    locLabel: "Enter Location:",
    dateLabel: "Choose Date:",
    predictBtn: "Get Prediction",
    resultTitle: "Fishing Conditions:",
    fishTitle: "Fish Species Prediction:"
  },
  bn: {
    title: "à¦à¦†à¦‡ à¦®à¦¾à¦› à¦§à¦°à¦¾à¦° à¦•à§Œà¦¶à¦²",
    locLabel: "à¦…à¦¬à¦¸à§à¦¥à¦¾à¦¨ à¦²à¦¿à¦–à§à¦¨:",
    dateLabel: "à¦¤à¦¾à¦°à¦¿à¦– à¦¨à¦¿à¦°à§à¦¬à¦¾à¦šà¦¨ à¦•à¦°à§à¦¨:",
    predictBtn: "à¦­à¦¬à¦¿à¦·à§à¦¯à¦¦à§à¦¬à¦¾à¦£à§€ à¦¦à§‡à¦–à§à¦¨",
    resultTitle: "à¦®à¦¾à¦› à¦§à¦°à¦¾à¦° à¦…à¦¬à¦¸à§à¦¥à¦¾:",
    fishTitle: "à¦®à¦¾à¦›à§‡à¦° à¦¸à¦®à§à¦­à¦¾à¦¬à§à¦¯ à¦§à¦°à¦¨:"
  }
};

document.getElementById('langToggle').addEventListener('change', e => {
  const lang = e.target.checked ? 'bn' : 'en';
  const d = langData[lang];
  document.getElementById('title').innerText = d.title;
  document.getElementById('locLabel').innerText = d.locLabel;
  document.getElementById('dateLabel').innerText = d.dateLabel;
  document.getElementById('predictBtn').innerText = d.predictBtn;
});

async function detectLocation() {
  navigator.geolocation.getCurrentPosition(async pos => {
    const { latitude, longitude } = pos.coords;
    const res = await fetch(`https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=${latitude}&lon=${longitude}`);
    const data = await res.json();
    document.getElementById('location').value = data.display_name;
  });
}

async function geocode(location) {
  const res = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(location)}`);
  const data = await res.json();
  if (data.length > 0) {
    return { lat: data[0].lat, lon: data[0].lon };
  } else {
    throw new Error("Location not found");
  }
}

async function getFishingPrediction() {
  const lang = document.getElementById('langToggle').checked ? 'bn' : 'en';
  const loc = document.getElementById('location').value;
  const date = document.getElementById('fishingDate').value;
  if (!loc || !date) return alert(lang === 'en' ? "Please fill all fields" : "à¦¸à¦¬ à¦¤à¦¥à§à¦¯ à¦ªà§‚à¦°à¦£ à¦•à¦°à§à¦¨");

  try {
    const { lat, lon } = await geocode(loc);

    const weatherRes = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&daily=temperature_2m_max,precipitation_sum,wind_speed_10m_max&timezone=auto`);
    const weatherData = await weatherRes.json();

    const dayData = weatherData.daily;
    const index = dayData.time.indexOf(date);
    if (index === -1) throw new Error("Date out of forecast range");

    const temp = dayData.temperature_2m_max[index];
    const rain = dayData.precipitation_sum[index];
    const wind = dayData.wind_speed_10m_max[index];

    const phase = (new Date(date).getDate() % 29.53); // Simplified moon phase
    const moon = phase < 1 || phase > 28 ? "New Moon" : phase > 14 && phase < 16 ? "Full Moon" : "Mid Phase";

    const resultHTML = `
      <strong>${langData[lang].resultTitle}</strong><br>
      ğŸŒ¡ï¸ Temp: ${temp}Â°C<br>
      ğŸŒ§ï¸ Rain: ${rain}mm<br>
      ğŸ’¨ Wind: ${wind} m/s<br>
      ğŸŒ™ Lunar: ${moon}<br>
      ğŸ£ Chance: <b>${(temp >= 20 && temp <= 30 && rain < 5 && wind < 5) ? (lang === 'en' ? 'High' : 'à¦‰à¦šà§à¦š') : (lang === 'en' ? 'Moderate' : 'à¦®à¦§à§à¦¯à¦®')}</b>
    `;

    const fishList = `
      <strong>${langData[lang].fishTitle}</strong><br>
      ğŸŸ Rohu - 80%<br>
      ğŸ  Catla - 70%<br>
      ğŸ Tilapia - 50%<br>
    `;

    document.getElementById('result').innerHTML = resultHTML;
    document.getElementById('fishSpecies').innerHTML = fishList;

  } catch (e) {
    alert(e.message);
  }
}
</script>
</body>
</html>
