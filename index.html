<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>AI Fishing Strategy</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      font-family: sans-serif;
      background: linear-gradient(to right, #e0f7fa, #fff3e0);
      color: #004d40;
      padding: 20px;
      max-width: 600px;
      margin: auto;
      border-radius: 10px;
    }
    h1 {
      text-align: center;
      color: #00695c;
    }
    label, select, input, button {
      display: block;
      margin: 10px 0;
      width: 100%;
      font-size: 16px;
    }
    input, button {
      padding: 10px;
      border-radius: 5px;
      border: 1px solid #b2dfdb;
    }
    button {
      background: #ff6f00;
      color: white;
      cursor: pointer;
    }
    #result, #baitSuggestion {
      margin-top: 20px;
      padding: 15px;
      background: #ffffff;
      border-left: 5px solid #ff6f00;
      border-radius: 5px;
    }
    .lang-switch {
      float: right;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <div class="lang-switch">
    <label>
      <input type="checkbox" id="langToggle"> ржмрж╛ржВрж▓рж╛
    </label>
  </div>
  <h1 id="title">AI Fishing Strategy</h1>

  <label id="locLabel">Your Location:</label>
  <input type="text" id="location" readonly>

  <label id="dateLabel">Choose Date:</label>
  <input type="date" id="fishingDate">

  <button onclick="getFishingPrediction()" id="predictBtn">Get Prediction</button>

  <div id="result"></div>
  <div id="baitSuggestion"></div>

  <script>
    const langData = {
      en: {
        title: "AI Fishing Strategy",
        locLabel: "Your Location:",
        dateLabel: "Choose Date:",
        predictBtn: "Get Prediction",
        resultTitle: "Fishing Success Prediction:",
        baitTitle: "Suggested Bait:",
        error: "Please select a date!",
        geoFail: "Unable to detect location."
      },
      bn: {
        title: "ржПржЖржЗ ржорж╛ржЫ ржзрж░рж╛рж░ ржХрзМрж╢рж▓",
        locLabel: "ржЖржкржирж╛рж░ ржЕржмрж╕рзНржерж╛ржи:",
        dateLabel: "рждрж╛рж░рж┐ржЦ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржи:",
        predictBtn: "ржнржмрж┐рж╖рзНржпржжрзНржмрж╛ржгрзА ржжрзЗржЦрзБржи",
        resultTitle: "ржорж╛ржЫ ржзрж░рж╛рж░ рж╕ржорзНржнрж╛ржмржирж╛:",
        baitTitle: "рж╕рзБржкрж╛рж░рж┐рж╢ржХрзГрждщдМ:",
        error: "ржЕржирзБржЧрзНрж░рж╣ ржХрж░рзЗ ржПржХржЯрж┐ рждрж╛рж░рж┐ржЦ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржи!",
        geoFail: "ржЕржмрж╕рзНржерж╛ржи рж╕ржирж╛ржХрзНржд ржХрж░рж╛ ржпрж╛ржпрж╝ржирж┐ред"
      }
    };

    // Switch language
    document.getElementById('langToggle').addEventListener('change', (e) => {
      const lang = e.target.checked ? 'bn' : 'en';
      swapLanguage(lang);
    });

    function swapLanguage(lang) {
      const d = langData[lang];
      document.getElementById('title').innerText = d.title;
      document.getElementById('locLabel').innerText = d.locLabel;
      document.getElementById('dateLabel').innerText = d.dateLabel;
      document.getElementById('predictBtn').innerText = d.predictBtn;
    }

    // Auto-detect location
    async function detectLocation() {
      const locInput = document.getElementById('location');
      try {
        navigator.geolocation.getCurrentPosition(async (pos) => {
          const lat = pos.coords.latitude;
          const lon = pos.coords.longitude;
          const res = await fetch(`https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=${lat}&lon=${lon}`);
          const data = await res.json();
          locInput.value = data.address.city || data.address.town || data.address.village || "Unknown";
        });
      } catch {
        locInput.value = langData[getLang()].geoFail;
      }
    }

    detectLocation();

    function getLang() {
      return document.getElementById('langToggle').checked ? 'bn' : 'en';
    }

    function getMoonPhase(dateStr) {
      const date = new Date(dateStr);
      const synodicMonth = 29.53058867;
      const newMoon = new Date('2000-01-06T18:14:00Z'); // Known new moon
      const daysSinceNew = (date - newMoon) / 86400000;
      const phase = daysSinceNew % synodicMonth;
      if (phase < 1.5 || phase > 28) return "New Moon";
      if (Math.abs(phase - 14.8) < 1.5) return "Full Moon";
      return "Other";
    }

    async function getFishingPrediction() {
      const location = document.getElementById('location').value;
      const date = document.getElementById('fishingDate').value;
      const lang = getLang();

      if (!date) {
        alert(langData[lang].error);
        return;
      }

      const apiKey = "YOUR_API_KEY_HERE";
      const weatherRes = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${location}&appid=${apiKey}&units=metric`);
      const weatherData = await weatherRes.json();

      if (weatherData.cod !== 200) {
        document.getElementById('result').innerText = lang === 'en' ? "Location not found!" : "ржЕржмрж╕рзНржерж╛ржи ржЦрзБржБржЬрзЗ ржкрж╛ржУржпрж╝рж╛ ржпрж╛ржпрж╝ржирж┐!";
        return;
      }

      const temp = weatherData.main.temp;
      const humidity = weatherData.main.humidity;
      const wind = weatherData.wind.speed;
      const moonPhase = getMoonPhase(date);

      let baseScore = (30 - Math.abs(22 - temp)) + (100 - humidity) * 0.1 - wind;
      if (moonPhase === "Full Moon" || moonPhase === "New Moon") baseScore += 5;

      let chance = baseScore > 20 ? "High" : baseScore > 15 ? "Medium" : "Low";

      const fishBaits = {
        en: {
          High: "Use worms, insects, or minnows.",
          Medium: "Try bread, corn, or dough bait.",
          Low: "Fish may not bite today. Try natural bait near plants."
        },
        bn: {
          High: "ржХрзЗржБржЪрзЛ, ржкрзЛржХрж╛ржорж╛ржХржбрж╝ ржмрж╛ ржЫрзЛржЯ ржорж╛ржЫ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржиред",
          Medium: "рж░рзБржЯрж┐, ржнрзБржЯрзНржЯрж╛ ржмрж╛ ржоржпрж╝ржжрж╛рж░щдМ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржиред",
          Low: "ржЖржЬ ржорж╛ржЫ ржХрж╛ржоржбрж╝рж╛рждрзЗ ржкрж╛рж░рзЗ ржирж╛ред ржЧрж╛ржЫрзЗрж░ ржХрж╛ржЫрж╛ржХрж╛ржЫрж┐ ржкрзНрж░рж╛ржХрзГрждрж┐ржХщдМ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржиред"
        }
      };

      const phaseText = moonPhase === "New Moon" ? (lang === 'en' ? "ЁЯМС New Moon" : "ЁЯМС ржЕржорж╛ржмрж╕рзНржпрж╛") :
                        moonPhase === "Full Moon" ? (lang === 'en' ? "ЁЯМХ Full Moon" : "ЁЯМХ ржкрзВрж░рзНржгрж┐ржорж╛") :
                        (lang === 'en' ? "ЁЯМУ Regular Phase" : "ЁЯМУ рж╕рж╛ржзрж╛рж░ржг ржЪрж╛ржБржж");

      document.getElementById('result').innerHTML =
        `<strong>${langData[lang].resultTitle}</strong><br>
         ЁЯМбя╕П Temp: ${temp}┬░C<br>ЁЯТз Humidity: ${humidity}%<br>ЁЯТи Wind: ${wind} m/s<br>${phaseText}<br>ЁЯОг Chance: <b>${lang === 'en' ? chance : (chance === "High" ? "ржЙржЪрзНржЪ" : chance === "Medium" ? "ржоржзрзНржпржо" : "ржХржо")}</b>`;
      document.getElementById('baitSuggestion').innerHTML =
        `<strong>${langData[lang].baitTitle}</strong><br>${fishBaits[lang][chance]}`;
    }
  </script>
</body>
</html>
